시니어 정신건강 분석 시스템 - 측정 체계 상세 문서

  1. 측정 지표 체계

  1.1 5대 핵심 정신건강 지표

  DRI (Depression Risk Index) - 우울 위험도

  - 정의: 노인의 우울증 위험 수준을 0-1 범위로 정량화
  - 구성 요소:
    - Librosa 음성 특징 (40%)
        - 말속도 저하: < 2.5 음절/초
      - 에너지 감소: < 0.015 RMS
      - 침묵 증가: > 50% pause ratio
    - GPT-4o 텍스트 분석 (60%)
        - 부정적 감정 표현
      - 무기력한 언어 패턴
      - 희망 결여 표현
    - SincNet 딥러닝 (Phase 2+: 50%)
        - 우울증 음성 패턴 학습 모델

  SDI (Sleep Disorder Index) - 수면 장애 지수

  - 정의: 불면증 및 수면 질 저하 정도를 0-1 범위로 측정
  - 구성 요소:
    - Librosa 음성 특징 (40%)
        - 피로한 음성 (에너지 < 0.01)
      - 음성 변동성 감소 (energy_std < 0.005)
      - 느린 말속도 (< 2.0 음절/초)
    - GPT-4o 텍스트 분석 (60%)
        - 피로 관련 표현
      - 수면 문제 언급
      - 집중력 저하 표현
    - SincNet 딥러닝 (Phase 2+: 50%)
        - 불면증 음성 패턴 학습 모델

  CFL (Cognitive Function Level) - 인지 기능 수준

  - 정의: 인지 능력 및 정신 명료도를 0-1 범위로 평가 (높을수록
  좋음)
  - 구성 요소:
    - Librosa 음성 특징 (15%)
        - 말속도 일관성 (2.5-4.0 음절/초)
      - 적절한 침묵 비율 (< 40%)
    - GPT-4o 텍스트 분석 (85%)
        - 문장 완성도
      - 논리적 일관성
      - 단어 찾기 능력
      - 주제 유지 능력

  ES (Emotional Stability) - 감정 안정성

  - 정의: 감정 조절 능력과 정서적 균형을 0-1 범위로 측정 (높을수록     
   좋음)
  - 구성 요소:
    - Librosa 음성 특징 (40%)
        - 피치 안정성 (pitch_std < 15Hz)
      - 에너지 안정성 (energy_std < 0.02)
    - GPT-4o 텍스트 분석 (60%)
        - 감정 표현 일관성
      - 극단적 감정 부재
      - 긍정/부정 균형
    - SincNet 딥러닝 (Phase 2+: 20%)
        - 역산 점수 (1 - depression_score)

  OV (Overall Vitality) - 전반적 활력도

  - 정의: 전체적인 생활 에너지와 참여도를 0-1 범위로 평가
  (높을수록 좋음)
  - 구성 요소:
    - Librosa 음성 특징 (50%)
        - 음성 에너지 레벨
      - 활발한 말속도 (> 3.0 음절/초)
      - 높은 음성 활동 비율 (> 70%)
    - GPT-4o 텍스트 분석 (50%)
        - 참여 의지 표현
      - 미래 계획 언급
      - 긍정적 활동 언급

  1.2 보조 측정 지표

  시니어 식별 점수

  - 범위: 0-1 (0.6 이상이면 시니어로 판정)
  - 구성:
    - 음성 특징 점수 (60%)
        - 피치: 85-160Hz (한국 노인 기준)
      - 말속도: 1.8-3.5 음절/초
      - 떨림: jitter > 0.008, shimmer > 0.04
    - 텍스트 패턴 점수 (40%)
        - 반말 사용 비율
      - 호칭 사용 패턴

  2. 측정 방법

  2.1 Google Cloud Speech API - 화자 분리

  # 화자 분리 설정
  config = {
      "encoding": "LINEAR16",
      "sample_rate_hertz": 16000,
      "language_code": "ko-KR",
      "enable_speaker_diarization": True,
      "diarization_speaker_count": 2,  # 예상 화자 수
      "enable_word_confidence": True
  }
  - 출력: 화자별 세그먼트 (시작시간, 종료시간, 텍스트)

  2.2 Librosa - 음성 특징 추출

  # 주요 특징 추출
  - 피치: librosa.piptrack()
  - 에너지: librosa.feature.rms()
  - MFCC: librosa.feature.mfcc(n_mfcc=13)
  - 스펙트럼: librosa.feature.spectral_centroid()
  - 말속도: librosa.onset.onset_detect() 기반 추정

  2.3 GPT-4o - 텍스트 분석

  # 분석 프롬프트 구조
  {
      "role": "mental_health_analyzer",
      "metrics": [
          "depression_score",
          "fatigue_score",
          "cognitive_score",
          "emotion_stability",
          "engagement_score"
      ],
      "output_range": [0, 1]
  }

  2.4 SincNet - 딥러닝 분석

  # 모델 구조
  - 입력: 3초 오디오 (48000 샘플 @ 16kHz)
  - SincConv Layer: 80 filters, 251 taps
  - CNN Layers: 60-60 filters
  - DNN Layers: 6420->2048->2048->2
  - 출력: 우울/불면 확률

  3. 측정 순서 (7단계 파이프라인)

  1단계: 화자 분리 및 전사

  입력: 멀티스피커 오디오 파일
  처리: Google Cloud Speech API
  출력: {
      speaker_segments: [
          {speaker: 0, start: 0.0, end: 5.2, text: "..."},
          {speaker: 1, start: 5.2, end: 8.1, text: "..."}
      ]
  }
  시간: 오디오 길이의 0.3-0.5배

  2단계: 시니어 화자 식별

  입력: 화자별 세그먼트
  처리:
    1. 음성 특징 분석 (세그먼트당 최대 3초)
    2. 시니어 점수 계산
    3. 텍스트 패턴 분석 (음성 실패 시)
  출력: senior_speakers = [{speaker_id: 0, confidence: 0.75, ...}]     
  시간: 화자당 1-2초

  3-5단계: 병렬 분석

  # ThreadPoolExecutor로 동시 실행
  with ThreadPoolExecutor(max_workers=3) as executor:

  3단계: Librosa 음성 특징 추출

  입력: 시니어 화자 오디오 세그먼트
  처리:
    - 모든 시니어 세그먼트 분석
    - 특징별 평균값 계산
  출력: {
      pitch_mean: 120.5,
      energy_mean: 0.018,
      speech_rate: 2.8,
      pause_ratio: 0.35,
      ...
  }
  시간: 세그먼트당 0.5초

  4단계: GPT-4o 텍스트 분석

  입력: 시니어 화자 텍스트 (결합)
  처리: 비동기 API 호출 (asyncio)
  출력: {
      depression_score: 0.3,
      fatigue_score: 0.4,
      cognitive_score: 0.8,
      emotion_stability: 0.7,
      engagement_score: 0.6
  }
  시간: 2-5초 (API 응답 시간)

  5단계: SincNet 분석 (Phase 2+)

  입력: 시니어 오디오 (최대 30초)
  처리:
    1. 세그먼트 추출 및 결합
    2. 모델 추론 (CPU/GPU)
  출력: {
      depression: 0.25,
      insomnia: 0.35
  }
  시간: 1-3초

  6단계: 5대 지표 계산

  입력: 3-5단계 결과
  처리: 가중 평균 계산
    - Phase별 가중치 적용
    - None 값 처리 (재정규화)
  출력: {
      DRI: {score: 0.32, risk_level: "caution", ...},
      SDI: {score: 0.38, risk_level: "caution", ...},
      CFL: {score: 0.75, risk_level: "normal", ...},
      ES: {score: 0.68, risk_level: "normal", ...},
      OV: {score: 0.65, risk_level: "normal", ...}
  }
  시간: < 0.1초

  7단계: 종합 리포트 생성

  입력: 모든 분석 결과
  처리:
    1. 전체 위험도 계산 (평균)
    2. 주요 발견사항 추출
    3. 권장사항 생성
  출력: {
      summary: {
          overall_risk: "moderate",
          senior_speakers: 1,
          audio_duration: 120.5
      },
      key_findings: [...],
      recommendations: [...],
      detailed_indicators: {...}
  }
  시간: < 0.1초

  4. Phase별 특징

  Phase 1 (MVP)

  - 사용 기술: Librosa + GPT-4o
  - 처리 시간: 5-10초
  - 정확도: 70-75%
  - 가중치: Librosa 15-50%, GPT-4o 50-85%

  Phase 2 (ENHANCED)

  - 사용 기술: Librosa + GPT-4o + SincNet
  - 처리 시간: 8-15초
  - 정확도: 80-85%
  - 가중치: Librosa 15-40%, GPT-4o 25-85%, SincNet 0-50%

  Phase 3 (OPTIMIZED)

  - 사용 기술: 모든 기술 + Fine-tuning
  - 처리 시간: 10-20초
  - 정확도: 85-90%
  - 가중치: 최적화된 비율

  5. 임계값 및 해석

  위험 수준 분류

  | 지표  | Good | Normal/Caution | Warning | Critical |
  |-----|------|----------------|---------|----------|
  | DRI | ≤0.3 | 0.3-0.6        | 0.6-0.8 | >0.8     |
  | SDI | ≤0.3 | 0.3-0.6        | 0.6-0.8 | >0.8     |
  | CFL | ≥0.9 | 0.7-0.9        | 0.4-0.7 | <0.4     |
  | ES  | ≥0.9 | 0.7-0.9        | 0.4-0.7 | <0.4     |
  | OV  | ≥0.9 | 0.7-0.9        | 0.4-0.7 | <0.4     |

  전체 위험도

  - Low: 평균 위험 점수 ≤ 1.0
  - Moderate: 평균 위험 점수 1.0-2.0
  - High: 평균 위험 점수 2.0-3.0
  - Critical: 평균 위험 점수 > 3.0

  6. 오류 처리 및 제약사항

  필수 요구사항

  - 최소 오디오 길이: 3초
  - 최소 텍스트 길이: 10단어
  - 샘플링 레이트: 16kHz (자동 변환)
  - 오디오 형식: WAV, MP3 지원

  실패 조건

  - 시니어 화자 미식별 → ValueError
  - GPT-4o API 실패 → RuntimeError
  - 음성 특징 추출 실패 → ValueError
  - 필수 데이터 부족 → ValueError

  성능 최적화

  - 병렬 처리: 3개 분석 동시 실행
  - 캐싱: 모델 로드 시 캐시 사용
  - 세그먼트 제한: 시니어당 최대 30초 분석





