# Week 4: Cloud Functions 개발 환경 - 이론편

## 📚 학습 목표
서버리스 컴퓨팅의 개념을 이해하고, Cloud Functions를 통해 백엔드 로직을 구현하는 방법을 학습합니다. Express.js와 함께 RESTful API를 구축하는 기초를 다집니다.

## 🌟 핵심 개념

### 1. 서버리스(Serverless) 컴퓨팅
**정의**: 서버 관리 없이 코드만 작성하여 실행하는 클라우드 컴퓨팅 모델

**전통적 서버 vs 서버리스**:
```
전통적 서버:
├── 서버 구매/임대 필요
├── 24시간 서버 가동
├── 직접 관리 필요
└── 고정 비용 발생

서버리스:
├── 서버 관리 불필요
├── 코드 실행 시만 작동
├── 자동 관리
└── 사용한 만큼만 비용
```

### 2. Cloud Functions 이해하기
Cloud Functions는 이벤트가 발생할 때 자동으로 실행되는 코드 조각입니다.

**Functions 종류**:
```javascript
// 1. HTTP Functions - API 엔드포인트
exports.apiEndpoint = onRequest((req, res) => {
  res.json({ message: "Hello World" });
});

// 2. Background Functions - 이벤트 트리거
exports.documentTrigger = onDocumentCreated('users/{userId}', (event) => {
  // 문서 생성 시 실행
});

// 3. Scheduled Functions - 정기 실행
exports.dailyTask = onSchedule('0 0 * * *', (event) => {
  // 매일 자정 실행
});
```

### 3. Express.js 프레임워크
Express는 Node.js 웹 애플리케이션 프레임워크로, API 서버를 쉽게 만들 수 있습니다.

**핵심 구성요소**:
- **라우팅**: URL 경로와 HTTP 메서드를 처리
- **미들웨어**: 요청과 응답 사이의 중간 처리
- **요청/응답**: 클라이언트와 서버 간 데이터 교환

### 4. CORS (Cross-Origin Resource Sharing)
다른 도메인에서의 리소스 접근을 허용하는 메커니즘

```javascript
// CORS 설정 예시
const corsOptions = {
  origin: ['http://localhost:3000'], // 허용할 도메인
  credentials: true,                  // 쿠키 허용
};
```

## 🔧 주요 구성 요소

### HTTP 메서드와 용도
| 메서드 | 용도 | 예시 |
|--------|------|------|
| **GET** | 데이터 조회 | 사용자 정보 가져오기 |
| **POST** | 데이터 생성 | 새 사용자 등록 |
| **PUT** | 데이터 수정 | 사용자 정보 업데이트 |
| **DELETE** | 데이터 삭제 | 사용자 삭제 |

### 미들웨어 파이프라인
```
요청(Request)
    ↓
[CORS 미들웨어]      // 도메인 검증
    ↓
[인증 미들웨어]       // 사용자 확인
    ↓
[유효성 검사]         // 데이터 검증
    ↓
[비즈니스 로직]       // 실제 처리
    ↓
응답(Response)
```

## 💡 용어 설명

| 용어 | 설명 | 예시 |
|-----|------|------|
| **Endpoint** | API의 접근 주소 | `/api/users` |
| **Middleware** | 중간 처리 소프트웨어 | 인증 체크 |
| **Request** | 클라이언트의 요청 | GET /api/users |
| **Response** | 서버의 응답 | 200 OK + 데이터 |
| **Route** | URL 경로 | `/api/health-data` |
| **Handler** | 요청 처리 함수 | `(req, res) => {}` |

## 📊 Cloud Functions 실행 흐름

```
┌─────────────────────────────────────┐
│         클라이언트 요청              │
│    (웹 앱 / 모바일 앱)              │
└────────────┬────────────────────────┘
             │
             ▼
┌─────────────────────────────────────┐
│      Firebase Gateway               │
│   (요청 라우팅 및 인증)              │
└────────────┬────────────────────────┘
             │
             ▼
┌─────────────────────────────────────┐
│      Cloud Functions                │
│  ┌─────────────────────────┐       │
│  │  콜드 스타트 체크         │       │
│  │  (인스턴스 생성 필요?)   │       │
│  └──────┬──────────────────┘       │
│         │                           │
│         ▼                           │
│  ┌─────────────────────────┐       │
│  │  Express 앱 초기화       │       │
│  │  - 미들웨어 설정         │       │
│  │  - 라우트 등록           │       │
│  └──────┬──────────────────┘       │
│         │                           │
│         ▼                           │
│  ┌─────────────────────────┐       │
│  │  요청 처리               │       │
│  │  - 데이터 검증           │       │
│  │  - 비즈니스 로직         │       │
│  │  - 데이터베이스 작업     │       │
│  └──────┬──────────────────┘       │
└─────────┼───────────────────────────┘
          │
          ▼
┌─────────────────────────────────────┐
│         응답 반환                    │
│    (JSON / HTML / 에러)             │
└─────────────────────────────────────┘
```

## 🎯 학습 체크리스트

- [ ] 서버리스 컴퓨팅의 장단점 이해
- [ ] Cloud Functions의 3가지 유형 구분
- [ ] Express.js 기본 구조 파악
- [ ] HTTP 메서드별 용도 이해
- [ ] 미들웨어 개념과 순서 이해
- [ ] CORS 설정의 필요성 인지

## 🔍 심화 개념

### 콜드 스타트 (Cold Start)
Function이 처음 실행되거나 오랫동안 사용되지 않았을 때 발생하는 초기화 지연

**해결 방법**:
- 최소 인스턴스 설정 (`minInstances`)
- 더 많은 메모리 할당
- 경량화된 코드 작성

### 동시성 (Concurrency)
하나의 Function 인스턴스가 동시에 처리할 수 있는 요청 수

```javascript
exports.myFunction = onRequest({
  concurrency: 100,  // 동시 처리 요청 수
  memory: '512MB',    // 메모리 할당
}, handler);
```

## 🚀 다음 단계
Week 5에서는 Firestore 데이터베이스를 사용하여 실제 데이터를 저장하고 관리하는 방법을 학습합니다.